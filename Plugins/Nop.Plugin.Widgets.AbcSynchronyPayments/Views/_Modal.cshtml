@using Nop.Plugin.Widgets.AbcSynchronyPayments.Models;
@model SynchronyPaymentModel

@{
    var monthCountMinus1 = Model.MonthCount -1;
}

<div id="equalPaymentsModal-@Model.ProductId" class="synchrony-payments-modal-outer">
    <div class="synchrony-payments-modal-middle">
        <div class="synchrony-payments-modal-inner" style="color: #@Model.ModalHexColor; border-color: #@Model.ModalHexColor">
            @if (@Model.IsMonthlyPaymentStyle)
            {
                <a href="@Model.ApplyUrl" target="_blank">
                    <img src="@Model.ImageUrl" style="float: left">
                </a>

                <span class="month-count">@Model.MonthCount</span>
                <div class="months-text">Months</div>
                <div class="financing-text" style="font-size: 1.25rem">Financing**</div>

                <h2 style="clear: both">No Interest for @Model.MonthCount Months**</h2>
                <h3>With a @Model.StoreName credit card. @Model.MonthCount equal monthly payments required.</h3>
                <p>
                    **Offer applies only to single-receipt qualifying purchases.  No interest will be charged on promo purchase and equal monthly
                    payments are required equal to inital promo purchase amount divided equally by the number of months in promo period until promo
                    is paid in full.  The equal monthly payment will be rounded to the next highest whole dollar and may be higher than the minimum
                    payment that would be required if the purchase was a non-promotional purchase.  Regular account terms apply to non-promotional
                    purchases.  For new accounts: Purchase APR is 29.99%; Minimum Interest Charge is $2.  Existing cardholders should see their
                    credit card agreement for their applicable terms.  The monthly payment shown equals the purchase price (excluding [taxes and
                    delivery]) divided by the number of months in the promo period. It is rounded to the next highest whole dollar. It is only
                    good for the financing shown. If you make these payments by the due date each month, you should pay off this purchase within
                    the promo period, if it is the only balance you are paying off. If you have other balances on your account, this payment will
                    be added to any other minimum monthly payments. Subject to credit approval.<br>
                    We reserve the right to discontinue or alter the terms of this offer at any time.
                </p>}
            else
            {
                <table class="min-payment-table">
                    <tr class="min-payment-table-labels">
                        <td>Promotional Purchase Amount</td>
                        <td>Estimated Minimum Monthly Payments Month 1-@monthCountMinus1</td>
                        <td>Estimated Final Payment Month @Model.MonthCount</td>
                        <td>Promotional Period</td>
                    </tr>
                    <tr class="min-payment-table-data">
                        <td>@Model.FullPrice.ToString("C").Replace(".00", "")</td>
                        <td>$@Model.MonthlyPayment</td>
                        <td>@Model.FinalPayment.ToString("C").Replace(".00", "")</td>
                        <td>@Model.MonthCount Month</td>
                    </tr>
                </table>
                <div class="min-payment-content">
                    <p>
                        The monthly payments shown are estimates only and may be
                        different than what will be required and shown on your
                        @Model.StoreName billing statement.
                    </p>
                    <p>
                        These estimated payments:
                    </p>
                    <ul>
                        <li>Equal:</li>
                        <li style="list-style: none">
                            <ul>
                                <li>
                                    For the first @monthCountMinus1 months: 3.5% of
                                    the promotional purchase amount (although on 
                                    your billing statement, the required minimum 
                                    monthly payment will decline as the remaining 
                                    balance declines each month).
                                </li>
                                <li>
                                    For month @Model.MonthCount: The remaining
                                    promotional purchase balance if you make the
                                    first @monthCountMinus1 monthly payments shown.
                                </li>
                            </ul>
                        </li>
                        <li>
                            Would pay off the promotional purchase amount within
                            the promotional period, but only if:
                        </li>
                        <li style="list-style: none">
                            <ul>
                                <li>
                                    There are no other balances on your account at
                                    any time during the promotional period. (If
                                    you have any additional balances on your
                                    account, the monthly payments applicable to
                                    those balances will increase your monthly 
                                    payment and may impact how payments are applied
                                    to this promotional purchase.)
                                </li>
                                <li>
                                    You make your monthly payments on time.
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <p>
                        Refer to your billing statement for the actual monthly
                        payment required each month and the final remaining
                        promotional purchase balance that must be paid in month
                        @Model.MonthCount to avoid interest on this purchase.
                    </p><br />
                    <p><b>
                        If the promotional purchase amount is not paid in full
                        within the promotional period, interest will be charged to
                        your account from the purchase date and your total payments
                        will be greater than the amount of the promotional purchase
                        amount.
                    </b></p><br />
                    <p><b>
                        IMPORTANT: These estimated monthly payments assume the
                        following promotional financing offer is applied to the
                        purchase:
                    </b></p><br />
                    <p><b>
                        No Interest If Paid in Full Within @Model.MonthCount Months*
                    </b></p>
                    <p>
                        On qualifying purchases with your
                        @Model.StoreName credit card between @Model.OfferValidFrom -
                        @Model.OfferValidTo. Interest will be charged to your
                        account from the purchase date if the promotional purchase
                        is not paid in full within @Model.MonthCount months.
                        Minimum monthly payments required.
                        <em style="color: blue; text-decoration: underline; cursor: pointer; font-size: 10px"
                            onclick="window.location.href = '/special-financing-information'">
                            See Details
                        </em>
                    </p>
                </div>
            }
        </div>
    </div>
</div>
<script>
    $('.deferredPricingIcon-@Model.ProductId').on('click', function () {
        var modal = document.getElementById('equalPaymentsModal-@Model.ProductId');
        isModalOpen = true;
        modal.style.display = "table";

        // Close the modal on click
        // This extends to the entire viewport
        modal.onclick = function (event) {
            isModalOpen = false;
            modal.style.display = "none";
        }

        return false;
    });
</script>