!function(t,n,s){var u,p="#color-squares-info";function i(t,e){if(e&&0<e.length)for(var r=0;r<e.length;r++)o=t,a=e[r],i=c=void 0,(l=s.getAttrValFromDom(p,"data-productbox-container-selector"))&&(0<(c=a.productElement.find(l)).find("ul.attribute-squares").length||c&&a.productId&&0<a.productId&&(d=a.productId,(u=n(o).filter("ul[data-productId='"+d+"']"))&&0<u.length&&(n(c).append(u),n(c).addClass("active"),(i=n(".product-item").has("[data-productid="+d+"]")).find(" .second-product-image").remove(),i.find(".product-box-attribute-square.preselected").click())));var o,a,c,d,u,i,l}t.getColorSquares=function(){var r,e=(r=[],n(u).each(function(){var t,e=n(this).attr("data-productid");e&&0<e&&(t={productId:e,productElement:n(this)},r.push(t))}),r);if(e&&0!==e.length){for(var t=[],o=0;o<e.length;o++){var a=e[o];a.hasOwnProperty("productId")&&t.push(a.productId)}var c={productIds:t},d=s.getAttrValFromDom(p,"data-retrieve-color-squares-url");n.ajax({cache:!1,type:"POST",data:n.toJSON(c),contentType:"application/json; charset=utf-8",url:d}).done(function(t){t&&(i(t,e),n.event.trigger({type:"colorSquaresLoadingCompleteEvent"}))})}},n(document).ready(function(){(u=s.getAttrValFromDom(p,"data-productbox-selector"))&&t.getColorSquares()}),n(document).on("click",".product-box-attribute-square",function(){var t,e,r,o=n(this),a=o.closest("li");a.hasClass("selected-value")||(t=s.getAttrValFromDom("#color-squares-info","data-product-attribute-change-url"),(e=o.closest(".product-item").data("productid"))&&0<e&&((r={})[o.attr("name")]=o.attr("value"),n.ajax({cache:!1,url:t+"?productId="+e+"&validateAttributeConditions=true&loadpicture=true",data:r,type:"POST",success:function(t){var e,r;t.price&&(e=s.getAttrValFromDom("#color-squares-info","data-productbox-price-selector"),0<(r=o.closest(".product-item").find(e)).length&&r.text(t.price)),t.pictureDefaultSizeUrl&&o.closest(".product-item").find(".picture img").attr("src",t.pictureDefaultSizeUrl)}})),a.addClass("selected-value"),a.siblings(".selected-value").removeClass("selected-value"))}),n(document).on("nopAjaxFiltersFiltrationCompleteEvent newProductsAddedToPageEvent",t.getColorSquares)}(window.colorSquares=window.colorSquares||{},jQuery,sevenSpikesCore);