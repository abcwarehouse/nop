var ReverseInfiniteScroll = function () { var n, l, e = { init: o, reset: f, createEmptySpaceFillContainer: d, activateReverseInfiniteScroll: p }, t = !1, r = ".nop7SpikesAjaxFiltersGrid .item-box", a = ".item-box.dummy-box", s = !1, i = !0, c = ajaxFiltersHistory.state().scrollPosition; function o() { n = ajaxFiltersHistory.state().visiblePage ? ajaxFiltersHistory.state().visiblePage : 1, $(window).on("scroll.reverseInfiniteScrollInit", function () { $(window).scrollTop(); t || (t = !0, scrollTimer = setTimeout(function () { u(), t = !1 }, 250)), t && clearTimeout(scrollTimer), scrollTimer = setTimeout(function () { scrollTimer = null, u(), p(), ajaxFiltersHistory.setScrollPosition($(window).scrollTop()), t = !1 }, 300) }), $(document).on("nopAjaxFiltersFiltrationCompleteEvent.reverseInfiniteScrollInit", function (e) { e.isTriggeredByInfiniteScroll || i || f(), d(), u(), p(), i = !1 }), $(document).ready(function () { l = parseInt($(".productsPageSizeDropDown").val() || $(".nop7SpikesAjaxFiltersGrid .item-box").length), 1 == n && (s = !0) }) } function f() { t = !1, s = !(r = ".nop7SpikesAjaxFiltersGrid .item-box"), _previousHash = window.location.hash, _isPreviousRequestFiltration = !1, i = !0, ajaxFiltersHistory.resetState(), o() } function u() { if (s) { var e = $(r), t = e.filter(function () { return e = $(this), t = $(e).offset().top, i = t + $(e).outerHeight(), r = $(window).scrollTop(), o = r + $(window).height(), r < i && t < o; var e, t, i, r, o }).last(), i = 0; for (i = 0; i < e.length; i++) { if ($(e.get(i)).is(t)) break } n = Math.ceil(i / l), ajaxFiltersHistory.setVisiblePage(n) } } function d() { if (!s) { var e, t = !1, i = $(".ajaxBusyPanelParent .item-grid"); for (e = n - 1; 0 < e; e--)for (var r = m(e), o = 0; o < l; o++)i.prepend(r), t = !0; t && setTimeout(function () { $("html, body").animate({ scrollTop: c }, 0) }, 500), s = !0 } } function p() { if (0 !== l) for (var e = $(a), t = l - 1; t < e.length; t += l) { var i = e.get(t), r = $(i).offset().top + $(i).outerHeight(!0) + 150; if ($(window).scrollTop() < r + 150) { _reverseInfiniteScrollTriggered = !0; var o = $(i).attr("data-pageNumber"); filterManager.executeReverseInfiniteScroll(o) } } } function m(e) { var t = $(r).first().clone(); $(t).find(".product-title").empty(), $(t).find(".prices").empty, $(t).find(".description").empty(), $(t).find(".picture a").removeAttr("href"), $(t).find(".picture a img").removeAttr("src"), $(t).addClass("dummy-box"), $(t).attr("data-pageNumber", e); var i = document.createElement("div"); return i.appendChild(t.get(0)), i.innerHTML } return e };