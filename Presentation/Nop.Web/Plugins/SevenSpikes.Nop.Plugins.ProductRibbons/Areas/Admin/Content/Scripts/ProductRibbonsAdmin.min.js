var ribbonType="",editRibbonPictureButtonElement="",pageRibbonTableSelector=".panel-group.page-ribbon";function setRibbonType(t){$(t).parents(".page-ribbon-settings").each(function(t,i){var e=$(i).attr("data-ribbontype");null!=e&&""!=e&&(ribbonType=e)})}function removeRibbonPictureFromDom(t){var i=getNoPlictureLableText();if(""!=i){var e="<label>"+i+"</label>";$(t).html(e)}}function removePictureId(){"category"==ribbonType&&null!=$("#CategoryPageRibbon_PictureId")&&$("#CategoryPageRibbon_PictureId").attr("value",0),"product"==ribbonType&&null!=$("#ProductPageRibbon_PictureId")&&$("#ProductPageRibbon_PictureId").attr("value",0)}function addAndDisplayRibbonPicturesGrid(){var t=$(".ribbonPicturesWindow").data("kendoWindow");null==t&&(populateWindowPictureGrid(),$(".ribbonPicturesWindow").kendoWindow({width:650,modal:!0,animation:!1}),t=$(".ribbonPicturesWindow").data("kendoWindow"));t.center(),$(".ribbonPicturesWindow").closest(".k-window").css("top","70px"),t.open()}function addRibbonPicturesGrid(){$("body").prepend('<div class="ribbonPicturesWindow"><div id="ribbon-pictures-grid"></div></div>')}function populateWindowPictureGrid(){var t=getSetRibbonPictureUrl();""!=t&&($("#ribbon-pictures-grid").kendoGrid({dataSource:new kendo.data.DataSource({transport:{read:{url:t,dataType:"json",type:"POST",data:addAntiForgeryToken}},schema:{data:"Data",total:"Total"},pageSize:10,serverPaging:!0}),selectable:"single",pageable:!0,columns:[{field:"Id",filterable:!1},{field:"PictureUrl",template:"<img src='${ PictureUrl }' alt='${ Id }' />",width:250},{field:"PictureHeight",filterable:!0},{field:"PictureWidth",filterable:!0}]}),$("#ribbon-pictures-grid").data("kendoGrid").hideColumn("Id"),$("#ribbon-pictures-grid tbody").on("click","tr",function(t){var i=$(this).find("img").attr("alt");i&&addPictureIdToTheMarkup(i,$(this).find("img").attr("src"))}))}function addPictureIdToTheMarkup(t,i){"category"==ribbonType&&null!=$("#CategoryPageRibbon_PictureId")&&setPictureId("#CategoryPageRibbon_PictureId",t,i),"product"==ribbonType&&null!=$("#ProductPageRibbon_PictureId")&&setPictureId("#ProductPageRibbon_PictureId",t,i)}function setPictureId(t,i,e){$(t).attr("value",i),$(".ribbonPicturesWindow").data("kendoWindow").close(),addPictureToDom(e,i),showDeleteRibbonPictureButton()}function showDeleteRibbonPictureButton(){var t=$(editRibbonPictureButtonElement).closest(".panel-group.page-ribbon").find(".remove-ribbon-picture");null!=t&&$(t).css("display","inline-block")}function addPictureToDom(t,i){var e=$(editRibbonPictureButtonElement);if(null!=e){var r=e.closest(".panel-group").find(".ribbon-image");if(null!=r){var n="<img src="+t+" alt="+i+" />";r.html(n)}}}function getRibbonPictureId(t){var i=$(t).attr("data-ribbonPictureId");return null==i||""==i?0:parseInt(i)||0}function getSetRibbonPictureUrl(){var t=$("#ribbon-data").attr("data-setRibbonPictureUrl");return null==t?"":t}function getNoPlictureLableText(){var t=$("#ribbon-data").attr("data-noPictureLabelText");return null==t?"":t}function getAddDeleteProductRibbonPictureUrl(t){var i=$(t).attr("data-addDeleteProductRibbonPictureUrl");return null==i?"":i}function getEditPictureUrl(t){var i=$(t).attr("data-editPictureUrl");return null==i||""==i?"":i}$(document).ready(function(){addRibbonPicturesGrid(),$(pageRibbonTableSelector).each(function(){var t=$(this).find(".ribbon-image label");null!=t&&0<t.length&&$(this).find(".remove-ribbon-picture").css("display","none")}),$("div.ribbon-picture-buttons .edit-ribbon-picture").click(function(){""!=getEditPictureUrl(this)&&(editRibbonPictureButtonElement=this,$(editRibbonPictureButtonElement).parents(".page-ribbon-settings").each(function(t,i){var e=$(i).attr("data-ribbontype");null!=e&&""!=e&&(ribbonType=e)}),addAndDisplayRibbonPicturesGrid())}),$("div.ribbon-picture-buttons .remove-ribbon-picture").on("click",function(){var t=$(this).closest(".panel-group").find("div.ribbon-image");null!=t&&null!=$(t).find("img")&&(setRibbonType(this),removePictureId(),removeRibbonPictureFromDom(t),$(this).css("display","none"))}),$(".manage-ribbon-pictures").click(function(){window.location.href=getAddDeleteProductRibbonPictureUrl(this)})});